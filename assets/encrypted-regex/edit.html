<label>
	Encrypted Regex Flag
</label>
<div class="form-group">
	<label><small>Regex statement</small></label>
	<input type="text" class="form-control" name="content" placeholder="regex" value="{{ content }}">
</div>
<div class="form-group">
	<label><small>Encryption key (16 bytes)</small></label>
	<input type="text" class="form-control" name="data" placeholder="regex" value="{{ data }}">
</div>
<div class="form-group">
	<label>Generation Example Code</label>
	{% raw %}
	<pre>
from Crypto.Cipher import AES
from Crypto.Random import get_random_bytes

SECRET_KEY = b'This is a secret!'  # Ensure this is 16 bytes
FLAG = 'unsafe_flag'

iv = get_random_bytes(16)
cipher = AES.new(SECRET_KEY, AES.MODE_CBC, iv)

timestamp = int(time.time())
flag_data = f"{FLAG}-{timestamp}"
flag_data = iv + cipher.encrypt(pad(flag_data.encode(), 16))
flag_data = base64.b64encode(flag_data).decode()

print(f"flag{" + flag_data + "}")
	</pre>
	{% endraw %}
</div>
<input type="hidden" name="type" value="encrypted-regex">
<input type="hidden" name="id" value="{{ id }}">
<hr>
<div class="form-group">
	<button class="btn btn-success float-right">Update</button>
</div>